<div class="d-flex min-vh-100">
  <app-sidebar />

  <div class="flex-grow-1 bg-light">

    <div class="bg-white border-bottom px-4 py-3
                d-flex align-items-center gap-3">
      <button class="btn btn-sm btn-outline-secondary"
              (click)="goBack()">‚Üê Back</button>
      <h6 class="mb-0 fw-semibold">
        {{ hearingId ? 'Pay Hearing Fee' : 'Pay Consultation Fee' }}
      </h6>
    </div>

    <div class="p-4">
      <div class="card border-0 shadow-sm" style="max-width: 560px;">
        <div class="card-body p-4">

          <!-- Info banner -->
          <div class="alert alert-info small py-2 mb-3">
            <span *ngIf="!hearingId">
              üíº Consultation fee for <b>Case #{{ caseId }}</b>
            </span>
            <span *ngIf="hearingId">
              üìÖ Hearing fee for
              <b>Case #{{ caseId }}</b>
            </span>
          </div>

          <div class="alert alert-danger small py-2"
               *ngIf="errorMessage">{{ errorMessage }}</div>

          <form [formGroup]="paymentForm" (ngSubmit)="onSubmit()">

            <!-- Amount ‚Äî display only, not editable -->
            <div class="mb-3">
              <label class="form-label small fw-semibold">
                Amount (‡ß≥)
              </label>
              <div class="form-control bg-light fw-bold text-primary"
                   style="cursor: not-allowed;">
                ‡ß≥ {{ paymentForm.get('amount')?.value | number }}
              </div>
              <input type="hidden" formControlName="amount"/>
            </div>

            <!-- Payment Method ‚Äî online only, no cash -->
            <div class="mb-3">
              <label class="form-label small fw-semibold">
                Payment Method
              </label>
              <select class="form-select"
                      formControlName="paymentMethodId"
                      [class.is-invalid]="isInvalid('paymentMethodId')">
                <option value="">Select method</option>
                <option *ngFor="let m of paymentMethods"
                        [value]="m.paymentMethodId">
                  {{ m.paymentMethodName }}
                </option>
              </select>
              <div class="invalid-feedback">
                Payment method is required.
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label small fw-semibold">
                Your Name
              </label>
              <input type="text"
                     class="form-control"
                     formControlName="customerName"
                     [class.is-invalid]="isInvalid('customerName')"/>
              <div class="invalid-feedback">Name is required.</div>
            </div>

            <div class="mb-3">
              <label class="form-label small fw-semibold">Email</label>
              <input type="email"
                     class="form-control"
                     formControlName="customerEmail"
                     [class.is-invalid]="isInvalid('customerEmail')"/>
              <div class="invalid-feedback">
                Valid email is required.
              </div>
            </div>

            <div class="row g-3 mb-4">
              <div class="col-6">
                <label class="form-label small fw-semibold">Phone</label>
                <input type="text"
                       class="form-control"
                       formControlName="customerPhone"
                       placeholder="01XXXXXXXXX"
                       [class.is-invalid]="isInvalid('customerPhone')"/>
                <div class="invalid-feedback">Phone is required.</div>
              </div>
              <div class="col-6">
                <label class="form-label small fw-semibold">Address</label>
                <input type="text"
                       class="form-control"
                       formControlName="customerAddress"
                       [class.is-invalid]="isInvalid('customerAddress')"/>
                <div class="invalid-feedback">
                  Address is required.
                </div>
              </div>
            </div>

            <button type="submit"
                    class="btn btn-primary w-100"
                    [disabled]="loading">
              <span *ngIf="loading"
                    class="spinner-border spinner-border-sm me-2"></span>
              {{ loading ? 'Redirecting to gateway...' : 'üí≥ Pay Now' }}
            </button>

          </form>
        </div>
      </div>
    </div>
  </div>
</div>
